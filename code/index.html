<!DOCTYPE HTML>
<!--
	Solarize by TEMPLATED
	templated.co @templatedco
	Released for free under the Creative Commons Attribution 3.0 license (templated.co/license)
-->
<html>

<head>
	<title>Migratory Goose</title>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta name="description" content="" />
	<meta name="keywords" content="" />
	<!--[if lte IE 8]><script src="css/ie/html5shiv.js"></script><![endif]-->
	<script src="js/template/jquery.min.js"></script>
	<script src="js/template/jquery.dropotron.min.js"></script>
	<script src="js/template/skel.min.js"></script>
	<script src="js/template/skel-layers.min.js"></script>
	<script src="js/template/init.js"></script>
	<script src="node_modules/canvas-datagrid/dist/canvas-datagrid.js"></script>
	<noscript>
		<link rel="stylesheet" href="css/skel.css" />
		<link rel="stylesheet" href="css/style.css" />
	</noscript>
	<!--[if lte IE 8]><link rel="stylesheet" href="css/ie/v8.css" /><![endif]-->
</head>

<body class="homepage">

	<!-- Header Wrapper -->
	<div class="wrapper style1">

		<!-- Header -->
		<div id="header">
			<div class="container">
				<!-- Nav -->
				<nav id="nav">
					<ul>
						<li class="active"><a href="index.html">Migratory Goose</a></li>
						<li><a href="documentation.html">Documentation</a></li>
					</ul>
				</nav>
			</div>
		</div>

		<!-- Banner -->
		<div id="banner">
			<section class="container">
				<p>Description</p>
			</section>
		</div>

	</div>

	<!-- Presentation Section -->
	<div class="wrapper style3">
		<section class="container">

			<header class="major">
				<h2>Instructions</h2>
			</header>

			<p>Pellentesque pede. Donec pulvinar ullamcorper metus. In eu odio at lectus pulvinar mollis. Vestibulum sem magna, elementum vestibulum arcu.</p>
		</section>
	</div>

	<!-- Game Section -->
	<div class="wrapper style4">
		<section class="container">

			<header class="major">
				<span class="byline">pulvinar mollis. Vestibulum sem magna, elementum vestibulum arcu.</span>
			</header>

			<div id="content" class="container">
				<!-- Parameters choices -->
				<div id="menu" class="">
				</div>

				<!-- Simulation map -->
				<canvas id="map" width="500" height="500"></canvas>
				<!-- <canvas-datagrid id="map">[
					{"col1": "row 1 column 1", "col2": "row 1 column 2"},
					{"col1": "row 2 column 1", "col2": "row 2 column 2"}
					]</canvas-datagrid> -->
				<!-- Toutes les div de la map doivent avoir la classe onMap -->

			</div>
	</div>

	<!-- <div class="row flush">
						<div class="4u">
							<ul class="special-icons">
								<li>
									<span class="fa fa-cogs"></span>
									<h3>Nulla luctus eleifend</h3>
									<p>In posuere eleifend odio. Quisque semper augue mattis wisi. Maecenas ligula pellentesque.</p>
									<a href="#" class="button alt">Modèle bouton</a>
								</li>
								<li>
									<span class="fa fa-leaf"></span>
									<h3>Fusce ultrices fringilla</h3>
									<p>Maecenas pede nisl, elementum eu, ornare ac, malesuada at, erat. Proin gravida orci porttitor.</p>
									<a href="#" class="button alt">Modèle bouton</a>
								</li>
							</ul>
						</div>
					</div> -->

	</section>
	</div>

	<!-- Footer -->
	<div id="footer">
		<section class="container">
			<header class="major">
				<span class="byline">...</span>
			</header>
			<ul class="icons">
				<li class="active"><a href="#" class="fa fa-facebook"><span>Facebook</span></a></li>
			</ul>
			<hr />
		</section>

		<!-- Copyright -->
		<div id="copyright">
			Design: <a href="http://templated.co">TEMPLATED</a> Images: <a href="http://unsplash.com">Unsplash</a> (<a href="http://unsplash.com/cc0">CC0</a>)
		</div>
	</div>

	<script type="text/javascript">
		//Récupère l'élément canvas
		let canvasMap = document.getElementById("map");
		//getContext conduit à la création d'un objet de représentation 2D
		let canvasContext = canvasMap.getContext("2d");
		//Les 0 correspondent aux coordonnées x et y du coin en haut à gauche du canvas à partir duquel on commence la copie
		let canvasData = canvasContext.getImageData(0, 0, canvasMap.width, canvasMap.height);

		//Création de la grille sur le canvas
		//Elements de la taille de la grille servant à la fonction drawBoard
		// Padding
		let p = 10; // Padding = marge
		let bw = 400; // Canvas width
		let bh = 400; // Canvas height
		//Modification de la taille du canvas
		canvasMap.height = bh + 2 * p;
		canvasMap.width = bw + 2 * p;

		//Fonction de dessin de la grille
		const drawBoard = () => {
			for (let x = 0; x <= bw; x += 40) {
				canvasContext.moveTo(0.5 + x + p, p);
				canvasContext.lineTo(0.5 + x + p, bh + p);
			}
			for (let x = 0; x <= bh; x += 40) {
				canvasContext.moveTo(p, 0.5 + x + p);
				canvasContext.lineTo(bw + p, 0.5 + x + p);
			}
			canvasContext.strokeStyle = "black";
			canvasContext.stroke();
		}
		//Appel à la fonction
		drawBoard();

		//Création de l'image de l'oiseau
		let birdPicture = new Image();
		birdPicture.src = 'images/bird.jpg';

		//On place l'oiseau dans le coin en haut à gauche de la grille. Le + 1 c'est pour évoter qu'il ne recouvre la grille
		let birdStartPositionX = p + 1;
		let birdStartPositionY = p + 1;

		let birdPositionX = birdStartPositionX;
		let birdPositionY = birdStartPositionY;

		//Affiche de l'image de l'oiseau une première fois
		birdPicture.onload = () => {
			canvasContext.drawImage(birdPicture, birdStartPositionX, birdStartPositionY);
		}

		//Un pas de l'image oiseau correspond à 24*p pour sauter d'une case à une autre puis que les cases font 40 px
		let step = 4 * p;

		//Fonction de déplacement de l'image avec les touches du clavier
		const deplacement = (event) =>
			// 38 = top, 37 = left, 39 = right, 40 = down
			{
				event.preventDefault();

				switch (event.keyCode) {
					case 37:
						// le + 2 * p permet de se caler dans la grille
						if (birdPositionX > 0 + 2 * p) {
							birdPositionX -= step;
						}
						break;
					case 38:
						if (birdPositionY > 0 + 2 * p) {
							birdPositionY -= step;
						}
						break;
					case 39:
						// le - 8 * p permet de se caler dans la grille
						if (birdPositionX < canvasMap.width - 8 * p) {
							birdPositionX += step;
						}
						break;
					case 40:
						if (birdPositionY < canvasMap.height - 8 * p) {
							birdPositionY += step;
						}
						break;
				}
				//On efface tout ce qu'il y a dans le canvas
				canvasContext.clearRect(0, 0, 500, 500);
				//On redessine la grlle
				drawBoard();
				//On redessine l'oiseau à la bonne position
				canvasContext.drawImage(birdPicture, birdPositionX, birdPositionY);
			}

		//Déplacement automatique toute les secondes	
		const deplacementV2 = () => {
			if (birdPositionX < canvasMap.width - 8 * p) {
				birdPositionX += step;
				//On efface tout ce qu'il y a dans le canvas
				canvasContext.clearRect(0, 0, 500, 500);
				//On redessine la grlle
				drawBoard();
				//On redessine l'oiseau à la bonne position
				canvasContext.drawImage(birdPicture, birdPositionX, birdPositionY);
			}
		}
		setInterval(deplacementV2, 1000);

		document.addEventListener("keydown", deplacement);
	</script>


</body>

</html>
